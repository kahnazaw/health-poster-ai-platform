-- ============================================================================
-- Database Migration V1: Create user_profiles table
-- ============================================================================
-- جدول الملفات الشخصية للمراكز الصحية الـ 23
-- User Profiles table for 23 Health Centers
--
-- Purpose: Stores profile settings for each Health Promotion Unit
-- الغرض: تخزين إعدادات الملف الشخصي لكل وحدة تعزيز صحة
--
-- This table is essential for:
-- - Dynamic footer display (Health Center Name + Manager Name)
-- - Logo path configuration
-- - Statistics tracking (posters_generated_count)
-- ============================================================================

CREATE TABLE IF NOT EXISTS user_profiles (
    id VARCHAR(255) PRIMARY KEY,
    user_id VARCHAR(255) UNIQUE NOT NULL,
    health_center_name VARCHAR(200),
    manager_name VARCHAR(150),
    directorate_name VARCHAR(200) DEFAULT 'دائرة صحة كركوك – قطاع كركوك الأول',
    logo_path VARCHAR(500) DEFAULT 'logo.jpg',
    show_verification_badge BOOLEAN DEFAULT true,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ============================================================================
-- Indexes for Performance Optimization
-- ============================================================================
-- Create index for faster lookups by user_id (most common query)
CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id);

-- Create index for faster lookups by health center name
CREATE INDEX IF NOT EXISTS idx_user_profiles_health_center ON user_profiles(health_center_name);

-- ============================================================================
-- Table and Column Comments (for documentation)
-- ============================================================================
COMMENT ON TABLE user_profiles IS 'ملفات شخصية لوحدات تعزيز الصحة - 23 مركز صحي | User profiles for 23 Health Centers';
COMMENT ON COLUMN user_profiles.health_center_name IS 'اسم المركز الصحي | Health Center Name';
COMMENT ON COLUMN user_profiles.manager_name IS 'اسم مدير وحدة تعزيز الصحة | Manager of Health Promotion Unit Name';
COMMENT ON COLUMN user_profiles.directorate_name IS 'اسم المديرية | Directorate Name (Default: Kirkuk Health Directorate - First Sector)';
COMMENT ON COLUMN user_profiles.logo_path IS 'مسار الشعار الرسمي (logo.jpg) | Official logo path (logo.jpg)';
COMMENT ON COLUMN user_profiles.show_verification_badge IS 'إظهار شارة التحقق | Show verification badge on posters';
COMMENT ON COLUMN user_profiles.posters_generated_count IS 'عدد البوسترات المولدة | Count of posters generated by this center';
COMMENT ON COLUMN user_profiles.created_at IS 'تاريخ الإنشاء | Creation timestamp';
COMMENT ON COLUMN user_profiles.updated_at IS 'تاريخ آخر تحديث | Last update timestamp (used as Last Activity)';

